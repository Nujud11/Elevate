{% load wagtailimages_tags static wagtailcore_tags %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% if page.seo_title %}{{ page.seo_title }}{% else %}{{ page.title }}{% endif %}{% endblock %} | Elevate</title>
    
    {% load static %}
    <link rel="icon" type="image/png" href="{% static 'elevate_ui/img/favicon.png' %}">
    <link rel="apple-touch-icon" href="{% static 'elevate_ui/img/favicon.png' %}">
    <meta charset="utf-8" />

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand': '#1C352D', 'accent': '#A6B28B', 'rose': '#EEB4A6', 'ink': '#1F2937', 'muted': '#6B7280', 'line': '#E5E7EB', 'bg-soft': '#F7F7F8',
                    },
                    fontFamily: {
                        sans: ['Poppins', 'system-ui', 'sans-serif'],
                    },
                    screens: {
                        'lg': '980px',
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="{% static 'elevate_ui/css/base.css' %}">
    <link rel="stylesheet" href="{% static 'elevate_ui/css/components.css' %}">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    {% block extra_css %}{% endblock %}
</head>
<body class="bg-bg">

    {% load wagtailuserbar %}
    {% wagtailuserbar %}

    {% with settings.website.SiteSettings as s %}

        {% if s.header_bg %}
            {% image s.header_bg original as header_bg_img %}
        {% endif %}

        <header class="site-header sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <nav class="flex justify-between items-center py-4 lg:py-6" aria-label="Global">
                    <div class="flex items-center space-x-3">
                        <a href="/" class="flex-shrink-0 flex items-center">
                            {% if s.logo %}
                                {% image s.logo width-32 as logo_img %}
                                <img src="{{ logo_img.url }}" class="h-8 w-8 object-contain" alt="Elevate Logo">
                            {% else %}
                                <img src="{% static 'elevate_ui/img/logo.svg' %}" class="h-8 w-8 object-contain" alt="Elevate Logo">
                            {% endif %}
                        </a>
                        <span class="text-brand text-xl font-extrabold tracking-tight hidden sm:block">Elevate</span>
                    </div>

                    {% if request.user.is_authenticated and request.user.profile.role == 'company' %}
                        <div class="nav-main hidden lg:flex space-x-8">
                            <a href="/" class="text-ink hover:text-brand font-medium">Home</a>
                            <a href="{% url 'company_postings' %}" class="text-ink hover:text-brand font-medium">My Internships</a>
                            <a href="{% url 'company_all_applications' %}" class="text-ink hover:text-brand font-medium">Applicants</a>
                            <a href="{% slugurl 'about-us' %}" class="text-ink hover:text-brand font-medium">About Us</a>
                            <a href="{% slugurl 'contact-us' %}" class="text-ink hover:text-brand font-medium">Contact Us</a>
                        </div>
                    {% else %}
                        {# Default Student/Logged-out Navigation #}
                        <div class="nav-main hidden lg:flex space-x-8">
                            <a href="/" class="text-ink hover:text-brand font-medium">Home</a>
                            <a href="{% url 'student_browse' %}" class="text-ink hover:text-brand font-medium">Opportunities</a>
                            {% if request.user.is_authenticated %}<a href="{% url 'student_apps' %}" class="text-ink hover:text-brand font-medium">My Applications</a>{% endif %}
                            <a href="{% slugurl 'about-us' %}" class="text-ink hover:text-brand font-medium">About Us</a>
                            <a href="{% slugurl 'contact-us' %}" class="text-ink hover:text-brand font-medium">Contact Us</a>
                        </div>
                    {% endif %}

                    <div class="nav-auth hidden lg:flex space-x-3 items-center">
                        {% if request.user.is_authenticated %}
                            <a href="{% url 'account_profile' %}" class="btn btn-ghost btn-sm">My Profile</a>
                            <form method="post" action="{% url 'logout' %}">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-primary btn-sm">Logout</button>
                            </form>
                        {% else %}
                            <a href="{% url 'register' %}" class="btn btn-ghost btn-sm">Register</a>
                            <a href="{% url 'login' %}" class="btn btn-primary btn-sm">Login</a>
                        {% endif %}
                    </div>

                    <button id="mobile-menu-toggle" class="nav-toggle-btn lg:hidden text-ink p-2 rounded-md hover:bg-bg-soft" aria-label="Toggle navigation">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                    </button>
                </nav>

                <div id="nav-mobile-menu-dropdown" class="nav-mobile-menu lg:hidden">
                    </div>
            </div>
        </header>

        <main class="flex-grow">
          {% if messages %}
              <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4 text-center">
                  {% for message in messages %}
                  <div class="p-3 rounded-md mb-3 flex justify-between items-center 
                      {% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %} bg-rose/20 text-rose border border-rose/50
                      {% elif message.level == DEFAULT_MESSAGE_LEVELS.SUCCESS %} bg-green-100 text-green-700 border border-green-200
                      {% elif message.level == DEFAULT_MESSAGE_LEVELS.WARNING %} bg-yellow-100 text-yellow-700 border border-yellow-200
                      {% else %} bg-blue-100 text-blue-700 border border-blue-200
                      {% endif %}"
                       role="alert">
      
                      <p>{{ message|safe }}</p>
      
                      <button onclick="this.parentElement.style.display='none'" class="ml-4 text-current" aria-label="Dismiss alert">
                          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                      </button>
                  </div>
                  {% endfor %}
              </section>
          {% endif %}
      
          {% block content %}
          {% endblock content %}
        </main>

        {% if s.footer_bg %}
            {% image s.footer_bg original as footer_bg_img %}
        {% endif %}

        <footer class="site-footer bg-bg-soft border-t border-line mt-12"
                {% if s.footer_bg %}style="background-image: url('{{ footer_bg_img.url }}'); background-size: cover; background-position: center;"{% endif %}>
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-8 pb-8">
                    <div class="col-span-1">
                        <div class="flex items-center space-x-3 mb-2">
                            <a href="/" class="flex-shrink-0">
                                {% if s.logo %}
                                    {% image s.logo width-32 as logo_img_footer %}
                                    <img src="{{ logo_img_footer.url }}" class="h-8 w-8 object-contain" alt="Elevate Logo">
                                {% else %}<img src="{% static 'elevate_ui/img/logo.svg' %}" class="h-8 w-8 object-contain" alt="Elevate Logo">{% endif %}
                            </a>
                            <span class="text-brand text-lg font-extrabold tracking-tight">Elevate</span>
                        </div>
                        <p class="text-muted text-sm">{{ s.tagline }}</p>
                    </div>

                    <div class="col-span-1">
                        <h3 class="font-semibold text-ink mb-3">Company</h3>
                        <ul class="space-y-2 text-sm text-muted">
                            <li><a href="{% slugurl 'about-us' %}" class="hover:text-brand">About Us</a></li>
                            <li><a href="{% slugurl 'contact-us' %}" class="hover:text-brand">Contact Us</a></li>
                            <li><a href="/admin/" class="hover:text-brand">Admin</a></li>
                        </ul>
                    </div>

                    <div class="col-span-1 hidden md:block"></div>

                    <div class="col-span-1 flex flex-col justify-between items-start md:items-end">
                        <div class="flex space-x-4 mb-4">
                            </div>
                        <p class="text-xs text-muted mt-auto md:text-right">
                            &copy; 2022 AlwaysApply - Job Portal. All Rights Reserved
                        </p>
                    </div>
                </div>
            </div>
        </footer>
    {% endwith %}

    <script>
        // Mobile Menu Toggler Script
        document.getElementById('mobile-menu-toggle').addEventListener('click', function() {
            const menu = document.getElementById('nav-mobile-menu-dropdown');
            menu.classList.toggle('active');
        });
    </script>

    <script src="https://unpkg.com/htmx.org@1.9.12" integrity="sha384-HtnagG5mAXSst0sHlJg9zCQaEFiBvePXLVHMuAffVomVgpLMYRNI3WAJEMFLlBdt" crossorigin="anonymous"></script>
</body>
</html>


